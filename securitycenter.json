{
    "appid"       : "421c4b26-2254-41f0-8544-5619af2afa42",
    "name"      : "SecurityCenter",
    "description" : "Take action with Tenable's SecurityCenter",
    "publisher": "Phantom",
    "package_name": "phantom_securitycenter",
    "type": "vulnerability scanner",
    "license": "Copyright (c) Phantom Cyber Corporation 2016",
    "main_module" : "securitycenter_connector.pyc",
    "app_version": "1.3.0",
    "utctime_updated": "2016-05-27T00:32:59.000000Z",
    "product_vendor": "Tenable",
    "product_name": "securitycenter",
    "product_version_regex": ".*",
    "min_phantom_version": "1.0.240",
    "logo": "securitycenter.png",
    "configuration": {
          "base_url": {
            "description": "SecurityCenter instance URL (https://sc_instance.company.com)",
            "data_type": "string",
            "required": true,
            "order": 0
          },
          "verify_server_cert": {
            "data_type": "boolean",
            "description": "Verify server certificate",
            "required": true,
            "order": 1,
            "default": false
          },
          "username": {
            "description": "Username",
            "data_type": "string",
            "required": true
          },
	      "password": {
            "description": "Password",
            "data_type": "password",
            "required": true
          }
    },
    "actions": [
      {
        "action": "test connectivity",
        "description": "Validate the asset configuration for connectivity.",
        "type": "test",
        "identifier": "test_asset_connectivity",
        "read_only": true,
        "parameters": {
        },
        "output": [],
        "versions":"EQ(*)"
      },
      {
      "action": "scan ip",
      "description": "Runs a scan against a specified host.",
      "type": "investigate",
      "identifier": "scan_ip",
      "read_only": true,
      "parameters": {
        "target_to_scan": {
          "description": "IP(s) to scan - multiple targets separated by commas, no spaces",
          "data_type": "string",
          "contains": [ "ip", "host name" ],
          "primary": true,
          "required": true
          },
        "scan_policy_id": {
          "description": "SecurityCenter Scan Policy ID to use",
          "data_type": "numeric",
          "contains": [ "SecurityCenter Scan Policy ID"],
          "required": true
        }
      },
      "render": {
        "width": 12,
        "title": "Scan IP Info",
        "type": "table",
        "height": 5
      },
      "output": [
        {
            "data_path": "action_result.status",
            "data_type": "string"
        },
        {
            "data_path": "action_result.message",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.name",
            "data_type": "string"
        },
        {
          "data_path": "action_result.data.*.id",
          "data_type": "string",
          "contains": [ "SecurityCenter Scan ID"],
          "column_name": "Scan ID",
          "column_order": 6
        },
        {
          "data_path": "action_result.data.*.scanResultID",
          "data_type": "string",
          "contains": [ "SecurityCenter Scan Result ID"],
          "column_name": "Scan Result ID",
          "column_order": 0
        },
        {
          "data_path": "action_result.data.*.ipList",
          "data_type": "string",
          "contains": [ "ip","host name"],
          "column_name": "Scan Target(s)",
          "column_order": 1
        },
        {
          "data_path": "action_result.data.*.type",
          "data_type": "string",
          "contains": [],
          "column_name": "Scan Type",
          "column_order": 2
        },
        {
          "data_path": "action_result.data.*.policy.id",
          "data_type": "string",
          "contains": [ "SecurityCenter Scan Policy ID"],
          "column_name": "Scan Policy ID",
          "column_order": 3
        },
        {
          "data_path": "action_result.data.*.policy.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Scan Policy Name",
          "column_order": 4
        },
        {
          "data_path": "action_result.data.*.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Scan Name",
          "column_order": 5
        }
      ],
      "versions": "EQ(*)"
      },
      {
      "action": "list vulnerabilities",
      "description": "Query SecurityCenter for a list of Vulnerabilities associated with an IP or host name",
      "type": "investigate",
      "identifier": "list_vulnerabilities",
      "read_only": true,
      "parameters": {
        "list_vuln_host": {
        "description": "IP / host name of host to query",
        "data_type": "string",
        "contains": [
          "ip", "host name"
        ],
        "primary": true,
        "required": true
        }
      },
      "render": {
        "width": 18,
        "title": "IP/Host Vulnerability Information",
        "type": "table",
        "height": 5
      },
      "output": [
        {
            "data_path": "action_result.status",
            "data_type": "string"
        },
        {
            "data_path": "action_result.message",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.total_vulnerabilities",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.critical_vulns",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.high_vulns",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.medium_vulns",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.low_vulns",
            "data_type": "string"
        },
        {
            "data_path": "action_result.summary.info_vulns",
            "data_type": "string"
        },
        {
          "data_path": "action_result.data.*.results.*.severity.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Vuln Severity",
          "column_order": 0
        },
        {
          "data_path": "action_result.data.*.results.*.pluginID",
          "data_type": "string",
          "contains": [],
          "column_name": "Plugin ID",
          "column_order": 1
        },
        {
          "data_path": "action_result.data.*.results.*.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Plugin Name",
          "column_order": 2
        },
        {
          "data_path": "action_result.data.*.results.*.family.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Plugin Family Name",
          "column_order": 3
        }
        ],
      "versions": "EQ(*)"
      },
      {
      "action": "list policies",
      "description": "Lists the scan policies available in Tenable SecurityCenter",
      "type": "generic",
      "identifier": "list_policies",
      "read_only": true,
      "parameters": {},
      "render": {
        "width": 12,
        "title": "SecurityCenter Policies",
        "type": "table",
        "height": 5
      },
      "output": [
        {
            "data_path": "action_result.status",
            "data_type": "string"
        },
        {
            "data_path": "action_result.message",
            "data_type": "string"
        },
        {
          "data_path": "action_result.data.*.usable.*.id",
          "data_type": "string",
          "contains": [ "SecurityCenter Scan Policy ID"],
          "column_name": "Usable Scan Policy ID",
          "column_order": 0
        },
        {
          "data_path": "action_result.data.*.usable.*.name",
          "data_type": "string",
          "contains": [],
          "column_name": "Scan Policy Name",
          "column_order": 1
        }
      ],
      "versions": "EQ(*)"
      }
    ]
}
